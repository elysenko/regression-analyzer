---
name: Create FastAPI app with upload and health endpoints
status: open
created: 2026-01-20T20:36:31Z
updated: 2026-01-20T20:39:01Z
github: https://github.com/elysenko/regression-analyzer/issues/23
depends_on: [22]
parallel: false
conflicts_with: []
---

# Task: Create FastAPI app with upload and health endpoints

## Description

Create the FastAPI application with the upload and health check endpoints. This establishes the API foundation and enables file uploads.

## Acceptance Criteria

- [ ] Create `api/__init__.py` exposing the FastAPI app
- [ ] Create `api/main.py` with FastAPI app instance
- [ ] POST /api/v1/upload accepts multipart file upload
- [ ] GET /api/v1/health returns status and LLM availability
- [ ] GET /api/v1/providers lists available LLM providers
- [ ] File validation: CSV/Excel only, max 50MB
- [ ] CORS enabled for web frontends
- [ ] OpenAPI docs available at /docs

## Technical Details

### Main App (api/main.py)
```python
from fastapi import FastAPI, UploadFile, File, HTTPException
from fastapi.middleware.cors import CORSMiddleware
from .models import UploadResponse, HealthResponse
from .storage import Storage

app = FastAPI(
    title="Regression Analyzer API",
    version="1.0.0",
    description="REST API for regression analysis"
)

# CORS middleware
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"],
)

storage = Storage()

@app.post("/api/v1/upload", response_model=UploadResponse)
async def upload_file(file: UploadFile = File(...)):
    # Validate file type and size
    # Save via storage module
    # Return upload_id

@app.get("/api/v1/health", response_model=HealthResponse)
async def health_check():
    # Check LLM provider availability
    # Return health status

@app.get("/api/v1/providers")
async def list_providers():
    # Return available LLM providers
```

### File Validation
- Allowed extensions: .csv, .xlsx, .xls
- Max size: 50MB (50 * 1024 * 1024 bytes)
- Return 400 for invalid files

### Package Export (api/__init__.py)
```python
from .main import app
__all__ = ["app"]
```

## Dependencies

- [ ] Task 001: Pydantic models and storage module

## Effort Estimate

- Size: S
- Hours: 2-3
- Parallel: false (depends on 001)

## Definition of Done

- [ ] FastAPI app created and runnable
- [ ] Upload endpoint accepts files
- [ ] Health endpoint returns status
- [ ] CORS configured
- [ ] OpenAPI docs accessible
