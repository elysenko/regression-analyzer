---
name: Create Pydantic models and storage module
status: open
created: 2026-01-20T20:36:31Z
updated: 2026-01-20T20:39:01Z
github: https://github.com/elysenko/regression-analyzer/issues/22
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Create Pydantic models and storage module

## Description

Create the foundational Pydantic request/response models and a simple file-based storage module for managing uploaded files and analysis results.

## Acceptance Criteria

- [ ] Create `api/models.py` with all Pydantic schemas
- [ ] Create `api/storage.py` with file storage abstraction
- [ ] Upload response model includes upload_id, filename, size, status
- [ ] Analyze request model includes upload_id, target, context, skip_llm
- [ ] Results response model matches AnalysisResult.to_dict() format
- [ ] Storage module handles file save/load with UUID-based paths

## Technical Details

### Pydantic Models (api/models.py)
```python
# Request models
class AnalyzeRequest(BaseModel):
    upload_id: str
    target: Optional[str] = None
    context: Optional[str] = None
    skip_llm: bool = False

# Response models
class UploadResponse(BaseModel):
    upload_id: str
    filename: str
    size: int
    status: str = "uploaded"

class JobResponse(BaseModel):
    job_id: str
    status: str

class AnalysisResultResponse(BaseModel):
    # Matches AnalysisResult.to_dict() structure
    ...

class HealthResponse(BaseModel):
    status: str
    llm_available: bool
    providers: List[str]
```

### Storage Module (api/storage.py)
- `save_upload(file, filename) -> upload_id`: Save uploaded file, return UUID
- `get_upload_path(upload_id) -> Path`: Get path to uploaded file
- `save_result(job_id, result) -> None`: Save analysis result as JSON
- `get_result(job_id) -> dict`: Load analysis result
- `get_chart_path(job_id, chart_name) -> Path`: Get path to chart image

### File Structure
```
/tmp/regression-analyzer/
├── uploads/{upload_id}/
│   └── {original_filename}
└── results/{job_id}/
    ├── result.json
    └── charts/
        └── *.png
```

## Dependencies

- [ ] None - this is a foundational task

## Effort Estimate

- Size: S
- Hours: 2-3
- Parallel: true

## Definition of Done

- [ ] api/models.py created with all schemas
- [ ] api/storage.py created with file operations
- [ ] Models validated against PRD requirements
- [ ] Storage tested manually
