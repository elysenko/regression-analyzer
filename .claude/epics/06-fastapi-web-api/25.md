---
name: Add charts endpoint and finalize API
status: open
created: 2026-01-20T20:36:31Z
updated: 2026-01-20T20:39:01Z
github: https://github.com/elysenko/regression-analyzer/issues/25
depends_on: [24]
parallel: false
conflicts_with: []
---

# Task: Add charts endpoint and finalize API

## Description

Add the endpoint to serve generated chart images and finalize the API with proper response headers and cleanup.

## Acceptance Criteria

- [ ] GET /api/v1/charts/{job_id}/{name} serves chart PNG images
- [ ] Proper Content-Type header for images
- [ ] 404 for missing charts
- [ ] Add CLI command to run the API server
- [ ] Update pyproject.toml with FastAPI dependencies

## Technical Details

### Charts Endpoint
```python
from fastapi.responses import FileResponse

@app.get("/api/v1/charts/{job_id}/{chart_name}")
async def get_chart(job_id: str, chart_name: str):
    chart_path = storage.get_chart_path(job_id, chart_name)
    if not chart_path.exists():
        raise HTTPException(404, "Chart not found")

    return FileResponse(
        path=chart_path,
        media_type="image/png",
        filename=chart_name
    )
```

### CLI Command (add to cli.py)
```python
@cli.command()
@click.option("--host", default="0.0.0.0", help="Host to bind")
@click.option("--port", default=8000, help="Port to bind")
def serve(host: str, port: int):
    """Start the API server."""
    import uvicorn
    from regression_analyzer.api import app
    uvicorn.run(app, host=host, port=port)
```

### Dependencies (pyproject.toml)
```toml
[project.optional-dependencies]
api = [
    "fastapi>=0.109.0",
    "python-multipart>=0.0.6",
    "uvicorn>=0.27.0",
]
```

## Dependencies

- [ ] Task 003: Analyze and results endpoints

## Effort Estimate

- Size: S
- Hours: 1-2
- Parallel: false (depends on 003)

## Definition of Done

- [ ] Charts endpoint serves PNG images
- [ ] CLI `serve` command works
- [ ] Dependencies added to pyproject.toml
- [ ] Server starts and responds
