---
name: Implement LLMAnalyzer class with all analysis methods
status: open
created: 2026-01-20T19:26:14Z
updated: 2026-01-20T19:27:37Z
github: https://github.com/elysenko/regression-analyzer/issues/7
depends_on: [6]
parallel: false
conflicts_with: []
---

# Task: Implement LLMAnalyzer class with all analysis methods

## Description

Create the main LLMAnalyzer class that orchestrates all LLM-powered analysis methods. This includes context identification, column relevance analysis, header analysis for transpose detection, and the full analysis pipeline.

## Acceptance Criteria

- [ ] Create `src/regression_analyzer/analyzer/llm_analyzer.py`
- [ ] Implement `identify_context()` method for business context
- [ ] Implement `analyze_columns()` method for column relevance
- [ ] Implement `analyze_headers()` method for header detection
- [ ] Implement `should_transpose()` with logic layer
- [ ] Implement `full_analysis()` orchestrator method
- [ ] All methods use async/await pattern
- [ ] Works with existing LLMRunner from core module
- [ ] Update `__init__.py` to export LLMAnalyzer

## Technical Details

### File to Create
- `src/regression_analyzer/analyzer/llm_analyzer.py`

### LLMAnalyzer Methods
- `__init__(llm_runner, model)`: Initialize with LLMRunner
- `identify_context(df, user_context)`: Returns BusinessContext
- `analyze_columns(df, context)`: Returns ColumnAnalysis
- `analyze_headers(df)`: Returns HeaderAnalysis
- `should_transpose(df)`: Returns TransposeDecision (uses analyze_headers + logic)
- `full_analysis(df, user_context, check_transpose)`: Full pipeline

### Key Implementation Notes
- Use `format_table_as_markdown()` from prompts.py
- Transpose logic: if first_column_looks_like_headers AND NOT first_row_looks_like_headers
- Confidence scoring based on clarity of analysis
- Import `transpose_dataframe` from loader module when needed

## Dependencies

- Task 6 must be complete (models and prompts)
- LLMRunner from core/ module
- transpose_dataframe from loader module (PRD-01)

## Effort Estimate

- Size: S
- Hours: 1
- Parallel: false

## Definition of Done

- [ ] LLMAnalyzer class implemented per PRD specification
- [ ] All methods work with async/await
- [ ] Can be imported: `from regression_analyzer.analyzer import LLMAnalyzer`
- [ ] Works with any LLMRunner provider
